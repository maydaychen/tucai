<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>收藏</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="../../static/css/mui.min.css">
    <link rel="stylesheet" href="../../static/css/public.css">
    <link rel="stylesheet" href="../../static/fonts/iconfont.css">
    <link rel="stylesheet" href="../../static/css/iconfont.css">
    <link rel="stylesheet" href="../../static/css/home.css">
    <link rel="stylesheet" href="../../static/css/deliver.css">
    <style type="text/css">
        .mui-scroll-wrapper{
            margin-top: 45px;
        }
        /*.td_all .jobs .jobUl{*/
            /*padding-top:10px;*/
        /*}*/
        .td_looked .mui-table-view .mui-table-view-cell a{
            padding-left:0;
        }
        .td_looked .mui-table-view .mui-table-view-cell .mui-media-body{
            width:8rem;
            height:2rem;
            padding-left: .5rem;
            padding-top: 0;
            display:table;
        }
        .td_looked .mui-table-view .mui-table-view-cell .mui-media-body div{
            display:table-cell;
            height:2rem;
            vertical-align: middle;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: normal;
            text-align:justify;
            color:#757575;
        }
        .td_looked .mui-table-view .mui-table-view-cell .mui-media-object{
            width: 2.2rem;
            height:2rem;
            box-sizing: border-box;
            border-radius: 0;
            margin-top: 0;
        }
        .all_tips{
            text-align: center;
            position:absolute;
            top:100%;
            left:25%;
            padding-top:2rem
        }
        .all_tips div i{
            font-size:2rem;
            color:#cfcfcf;
        }
        .all_tips div{
            margin-bottom:.5rem;
        }
        .all_tips p{
            line-height: .5rem;
            color:#cfcfcf;
        }
        .mid_bar{
            background:#fff;
        }
        .td_container{
            padding-top:0;
        }
    </style>
</head>

<body >
<header class="titleBar">
    <a class="barLeft iconfont">&#xe604;</a>
    <p class="barTxt">我的收藏</p>
</header>
<div class="mui-scroll-wrapper">
    <div class="mui-scroll">
        <div class="mid_bar">
            <ul>
                <li class="total3"><span class="active" data-index="1">职位</span></li>
                <li class="total3"><span data-index="2">公司</span></li>
                <li class="total3"><span data-index="3">资讯</span></li>
            </ul>
        </div>
        <div class="td_container">
            <div class="all_tips" style="min-height:300px;display:none" >
                <div>
                    <i class="iconfont">&#xe6ce;</i>
                </div>
                <p>暂无收藏</p>
                <p>快去寻找心仪的职位吧</p>
            </div>
            <div class="td_all msg" style="min-height:500px">
                <div class="jobs" >
                    <ul class="jobUl">
                        <script type="text/html" id="listLi">
                            <% each lists as list%>
                                <li class="jobLi">
                                    <a class="ja" data-href="../../personal/jobDetail/jobDetail.html" data-id="<% list.id %>">
                                        <div class="jtxt">
                                            <span><% list.jobs_name %></span>
                                            <i><% list.salary_cn %></i>
                                        </div>
                                        <div class="jtxt">
                                            <p><% list.district_cn %> | <% list.experience_cn %> | <% list.education_cn %></p>
                                            <p><% list.addtime %>发布</p>
                                        </div>
                                        <div class="jinfo">
                                            <img src="../../static/images/yuantiao.jpg"/>
                                            <h1><% list.companyname%></h1>
                                            <p><% list.trade_cn %> | <% list.scale_cn %> | 不需要融资</p>
                                        </div>
                                    </a>
                                </li>
                            <% /each %>
                        </script>
                    </ul>
                </div>
                <div style="clear:both"></div>
            </div>
            <div class="td_view msg" style="display: none">
                <div class="jobs">
                    <ul class="jobUl">
                        <script type="text/html" id="listLi1">
                            <% each lists as list%>
                            <li class="jobLi">
                                <a class="ja" data-href="../../personal/jobDetail/companyInfo.html" data-id="<% list.id %>">
                                    <div class="jinfo">
                                        <img src="../../static/images/yuantiao.jpg"/>
                                        <h1><% list.companyname %></h1>
                                        <p> <% list.nature_cn %> | <% list.scale_cn %> | 不需要融资</p>
                                    </div>
                                </a>
                            </li>
                            <% /each %>
                        </script>
                    </ul>

                </div>
            </div>
            <div class="td_looked msg" style="display: none">
                <ul class="mui-table-view">
                    <script type="text/html" id="listLi2">
                        <% each lists as list%>
                            <li class="mui-table-view-cell mui-media">
                                <a data-href="../wiki/articalTop.html" data-id="<% list.id %>">
                                    <img class="mui-media-object mui-pull-left squares" src="<% list.thumb %>">
                                    <div class="mui-media-body">
                                        <div>
                                            <p><% list.title %></p>
                                            <p><% list.detail %></p>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        <% /each %>
                    </script>
                </ul>
            </div>
        </div>
    </div>
</div>

<script src="../../static/js/flexible.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/mui.min.js"></script>
<script src="../../static/js/update.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/tmodjs.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/jquery.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/fastclick.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/jquery.mockjax.js" type="text/javascript"></script>
<script src="../../static/js/api.js"></script>
<script>
    mui.init({
        statusBarBackground: '#41a6ff',
        swipeBack:true //启用右滑关闭功能
    });
    mui('.mui-scroll-wrapper').scroll({
        scrollY: true, //是否竖向滚动
        scrollX: false, //是否横向滚动
        startX: 0, //初始化时滚动至x
        startY: 0, //初始化时滚动至y
        indicators: true, //是否显示滚动条
        deceleration:0.0006, //阻尼系数,系数越小滑动越灵敏
        bounce: true //是否启用回弹
    });

    $(function(){
        FastClick.attach(document.body);
        collectJob();
    });

    function collectJob(){
        var parmas={};
        var collectJob=host+'c=Favorites&a=collection_job_list';
        ajaxRun(collectJob,parmas,true,'POST',function (data) {
            console.log('职位数据')
            console.log(data);
            if(data.statuscode==1){
                var content = template("listLi", {lists: data.result});
                $(".td_all .jobUl").html(content);
            }else{
                $('.td_all').hide();
                $('.all_tips').show();
                $('.all_tips').children('p:last-child').html('快去寻找心仪的职位吧！');
            }
        });
    }
    //获取资讯列表
    function loadTopLine(){
        var showTopLine=host + "c=favorites&a=collection_topline_list";
        var params={page:1,pagesize:10};
        ajaxRun(showTopLine,params,true,"POST",function(data){
            console.log(data);
            if(data.statuscode==1){
                var content = template("listLi2",{lists:data.result});
                $(".td_looked .mui-table-view").html(content);
            }else{
                $('.td_looked').hide();
                $('.all_tips').show();
                $('.all_tips').children('p:last-child').html('快去寻找心仪的资讯吧！');
            }
        })
    }
    function collectCompany(){
        //mui.toast('加载中...',{ duration:1000});
        var parmas={};
        var collectCompany=host+'c=Favorites&a=collection_company_list';
        ajaxRun(collectCompany,parmas,true,'POST',function (data) {
            console.log(data);
            if(data.statuscode==1){
                var content = template("listLi1", {lists: data.result});
                $(".td_view .jobUl").html(content);
            }else{
                $('.td_view').hide();
                $('.all_tips').show();
                $('.all_tips').children('p:last-child').html('快去寻找心仪的公司吧！');
            }
        });
    }
    $('.mid_bar span').click(function(e){
        e.preventDefault();
        index= $('.mid_bar span').index($(this));
        var inx=$(this).attr('data-index');
        if(inx==1){
            collectJob();
        }else if(inx==2){
            console.log('公司数据');
            collectCompany();
        }else{
            console.log('资讯数据');
            loadTopLine();
        }
        $(this).parent().siblings().children().removeClass('active');
        $(this).addClass('active');
        getShowHide(index);
    });
    function getShowHide(index){
        $('.msg').each(function(index1){
            if(index1==index){
                $(this).show().siblings().hide();
            }
        })
    }
    $(function(){
        $('.titleBar .barLeft').click(function(){
            // history.back() 或 history.go(-1)
            history.go(-1);
        })
    });

    //资讯跳转
    mui('.td_looked').on('tap','a',function(){
        var href=$(this).attr('data-href');
        var listId=$(this).attr('data-id');
        location.href=href+'?tid='+listId;
    });
    //td_view
    //公司跳转 res_id
    mui('.td_view').on('tap','a',function(){
        var href=$(this).attr('data-href');
        var listId=$(this).attr('data-id');
        location.href=href+'?res_id='+listId;
    });
    //td_all
    //职位跳转 jobDetailId
    mui('.td_all').on('tap','a',function(){
        var href=$(this).attr('data-href');
        var listId=$(this).attr('data-id')
        console.log(href+'?jobDetailId='+listId)
        location.href=href+'?jobDetailId='+listId;
    });
</script>
</body>

</html>