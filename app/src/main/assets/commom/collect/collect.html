<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>收藏</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="../../static/css/mui.min.css">
    <link rel="stylesheet" href="../../static/css/public.css">
    <link rel="stylesheet" href="../../static/fonts/iconfont.css">
    <link rel="stylesheet" href="../../static/css/iconfont.css">
    <link rel="stylesheet" href="../../static/css/home.css">
    <link rel="stylesheet" href="../../static/css/deliver.css">
    <style type="text/css">
         .mui-table-view .mui-table-view-cell a{
            padding-left:0;
        }
        .mui-table-view .mui-table-view-cell .mui-media-body{
            width:8rem;
            height:2rem;
            padding-left: .5rem;
            padding-top: 0;
            display:table;
        }
         .mui-table-view .mui-table-view-cell .mui-media-body div{
            display:table-cell;
            height:2rem;
            vertical-align: middle;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: normal;
            text-align:justify;
            color:#757575;
        }
         .mui-table-view .mui-table-view-cell .mui-media-object{
            max-width: 2.2rem;
             min-width:2.2rem;
            height:2rem;
            box-sizing: border-box;
            border-radius: 0;
            margin-top: 0;
        }
        .all_tips{
            text-align: center;
            position:absolute;
            top:35%;
            left:25%;
            padding-top:2rem
        }
        .all_tips div i{
            font-size:2rem;
            color:#cfcfcf;
        }
        .all_tips div{
            margin-bottom:.5rem;
        }
        .all_tips p{
            line-height: .5rem;
            color:#cfcfcf;
        }
        .mid_bar{
            background:#fff;
            margin-top:45px;
            position:fixed;
            height:40px;
        }
        #pullrefresh{
            padding-top:85px;
        }
         .jobUl{
             margin-top:0;
         }
        .widther{
            padding:0 .1rem;
        }
        .jtxt p span{
            font-size: .2rem;
        }
    </style>
</head>

<body >
<header class="titleBar">
    <a class="barLeft iconfont">&#xe604;</a>
    <p class="barTxt">我的收藏</p>
</header>
<div class="mid_bar">
    <ul>
        <li class="total3"><span class="active" data-index="1">职位</span></li>
        <li class="total3"><span data-index="2">公司</span></li>
        <li class="total3"><span data-index="3">资讯</span></li>
    </ul>
</div>
<div class="all_tips" style="min-height:300px;display:none" >
    <div>
        <i class="iconfont">&#xe6ce;</i>
    </div>
    <p>暂无收藏</p>
    <p>快去寻找心仪的职位吧</p>
</div>
<div id="pullrefresh" style="width: 100%; height: 100%; float: left; overflow: hidden">

    <div id="pullrefresh0" style="height:100%">

            <ul class="jobUl" id="dataList0" v-show="show==true" style="height:100%;overflow:auto;">
                        <li class="jobLi" v-for="item in jobsList">
                            <a class="ja" data-href="../../personal/jobDetail/jobDetail.html" :data-id="item.id">
                                <div class="jtxt">
                                    <span v-text="item.jobs_name"></span>
                                    <i v-text="item.salary_cn"></i>
                                </div>
                                <div class="jtxt">
                                    <p>
                                        <span v-text="item.district_cn"></span>
                                        <span class="widther">|</span>
                                        <span v-text="item.experience_cn"></span>
                                        <span class="widther">|</span>
                                        <span v-text="item.education_cn"></span>
                                    </p>
                                    <p>
                                        <span v-text="item.addtime"></span>
                                        <span>发布</span>
                                    </p>
                                </div>
                                <div class="jinfo">
                                    <img :src="item.logo? item.logo: '../../static/images/aboutTc.gif'"/>
                                    <h1 v-text="item.companyname"></h1>
                                    <p>
                                        <span v-text="item.trade_cn"></span>
                                        <span class="widther">|</span>
                                        <span v-text="item.scale_cn"></span>
                                        <span class="widther" v-if="item.finance!==''">|</span>
                                        <span v-if="item.finance!==''" v-text="item.finance"></span>
                                    </p>
                                </div>
                            </a>
                        </li>

                    </ul>


            <ul class="jobUl" id="dataList1"  v-show="show==true" style="height:100%;overflow:auto;">
                        <li class="jobLi" v-for="item in companyList">
                            <a class="ja" data-href="../../personal/jobDetail/companyInfo.html" :data-id="item.id">
                                <div class="jinfo">
                                    <img :src="item.logo? item.logo: '../../static/images/aboutTc.gif'"/>
                                    <h1 v-text="item.companyname"></h1>
                                    <p>
                                        <span v-text="item.trade_cn"></span>
                                        <span>|</span>
                                        <span v-text="item.scale_cn"></span>
                                        <span v-if="item.finance!==''">|</span>
                                        <span v-if="item.finance!==''" v-text="item.finance"></span>
                                    </p>
                                </div>
                            </a>
                        </li>
                    </ul>


            <ul class="mui-table-view jobUl" id="dataList2"  v-show="show==true">


                            <li class="mui-table-view-cell mui-media" v-for="item in topLineList">
                                <a data-href="../wiki/articalTop.html" :data-id="item.id">
                                    <img class="mui-media-object mui-pull-left squares" :src="item.thumb">
                                    <div class="mui-media-body">
                                        <div>
                                            <p v-text="item.title"></p>
                                            <p v-text="item.descp"></p>
                                        </div>
                                    </div>
                                </a>
                            </li>

                </ul>

    </div>
</div>

<script src="../../static/js/flexible.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/mui.min.js"></script>
<script src="../../static/js/update.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/tmodjs.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/jquery.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/fastclick.js" type="text/javascript" charset="utf-8"></script>
<script src="../../static/js/jquery.mockjax.js" type="text/javascript"></script>
<script src="../../static/js/api.js"></script>
<script src="../../static/js/vue.min.js"></script>
<script>
    mui.init({
        statusBarBackground: '#41a6ff',
        swipeBack:true //启用右滑关闭功能
    });

    $(function(){
        FastClick.attach(document.body);

    });
    var page=[1,1,1];
    var pageflag=[true,true,true];
    var pagesize=10;

    var collectJobs=new Vue({
        el:"#dataList0",
        data:{
            jobsList:[],
            show:true
        },
        methods:{
            loadCollectJobs:function(){
                var that=this;
                var parmas={page:page[0],pagesize:pagesize};
                var collectJob=host+'c=Favorites&a=collection_job_list';
                ajaxRun(collectJob,parmas,true,'POST',function (data) {
                    console.log('职位数据');
                    console.log(data);
                    if(data.statuscode==1){
                        that.jobsList=that.jobsList.concat(data.result);
                        that.show=true;
                        page[0]++;
                        pageflag[0]=true;
                    }else{

                    }
                });
            }
        }
    });
    collectJobs.loadCollectJobs();
    bindScroll($('#dataList0'),0);

    var  collectCompany=new Vue({
        el:"#dataList1",
        data:{
            companyList:[],
            show:false
        },
        methods:{
            loadCollectCompany:function(){
                var that=this;
                var parmas={page:page[1],pagesize:pagesize};
                var collectCompany=host+'c=Favorites&a=collection_company_list';
                ajaxRun(collectCompany,parmas,true,'POST',function (data) {
                    console.log(data);
                    if(data.statuscode==1){
                        that.companyList=that.companyList.concat(data.result);
                        that.show=true;
                        page[1]++;
                        pageflag[1]=true;
                    }else{

                    }
                });
            }
        }
    });
    collectCompany.loadCollectCompany();
    bindScroll($('#dataList1'),1);

    var collectTopLine=new Vue({
        el:"#dataList2",
        data:{
            topLineList:[],
            show:false
        },
        methods:{
            loadCollectTopLine:function(){
                var that=this;
                var showTopLine=host + "c=favorites&a=collection_topline_list";
                var params={page:page[2],pagesize:pagesize};
                ajaxRun(showTopLine,params,true,"POST",function(data){
                    console.log(data);
                    if(data.statuscode==1){
                        that.topLineList=that.topLineList.concat(data.result);
                        that.show=true;
                        page[2]++;
                        pageflag[2]=true;
                    }else{

                    }
                })
            }
        }
    });
    collectTopLine.loadCollectTopLine();
    bindScroll($('#dataList2'),2);

    //滚动函数
    function bindScroll(ele,num){
        ele.on('scroll', function() {
            var scrollHeight = $(this)[0].scrollHeight;
            var scrollTop = $(this)[0].scrollTop;
            var nDivHight = $(this).height();
            var tipHtml="<span id=\"loadTips\"><a></a></span>";
            if (pageflag[num] == true && scrollTop + nDivHight > scrollHeight - 30) {
                pageflag[num] = false;
                ele.append(tipHtml).show();
                setTimeout(function(){
                    if(num==0){
                        collectJobs.loadCollectJobs();
                        $('#loadTips').hide();
                    }else if(num==1){
                        collectCompany.loadCollectCompany();
                        $('#loadTips').hide();
                    }else {
                        collectTopLine.loadCollectTopLine();
                        $('#loadTips').hide();
                    }
                },1000)
            }
        });
    }

    $('.mid_bar').on('tap','span',function(){
        //渲染样式
        $(this).parent().siblings().children().removeClass('active');
        $(this).addClass('active');

        //获取index
        var index= $('.mid_bar span').index($(this));

        if(index==0){
            console.log('职位数据');
            collectJobs._data.show=true;
        }else if(index==1){
            console.log('公司数据');
            collectJobs._data.show=false;
            collectCompany._data.show=true;
        }else{
            console.log('资讯数据');
            collectJobs._data.show=false;
            collectCompany._data.show=false;
            collectTopLine._data.show=true;
        }
    });

    $(function(){
        $('.titleBar .barLeft').click(function(){
            // history.back() 或 history.go(-1)
            history.go(-1);
        })
    });

    //资讯跳转
    $('#dataList2').on('tap','a',function(){
        var href=$(this).attr('data-href');
        var listId=$(this).attr('data-id');
        location.href=href+'?tid='+listId;
    });

    //公司跳转 res_id
    $('#dataList1').on('tap','a',function(){
        var href=$(this).attr('data-href');
        var listId=$(this).attr('data-id');
        location.href=href+'?res_id='+listId;
    });

    //职位跳转 jobDetailId
    $('#dataList0').on('tap','a',function(){
        var href=$(this).attr('data-href');
        var listId=$(this).attr('data-id')
        console.log(href+'?jobDetailId='+listId)
        location.href=href+'?jobDetailId='+listId;
    });
</script>
</body>

</html>